% Define data as 3D array: [region, probability, scenario]
% Regions: NW, SW, MW, GP, NE, SE
% Probabilities: AD|D0-MD, D0-AD|D0-MD, ..., D4-AD|D0-MD
% Scenarios: Hist, 245CN, 245CF, 245HN, 245HF, 585CN, 585CF, 585HN, 585HF

data = zeros(6, 6, 9);

% Data matrix: data(region, probability_type, scenario)

% Region 1: NW
data(1,1,:) = [0.70165, 0.705, 0.718, 0.708, 0.723, 0.713, 0.736, 0.716, 0.74];     % HD|D4-MD
data(1,2,:) = [0.07368, 0.068, 0.053, 0.065, 0.068, 0.067, 0.059, 0.06, 0.055];      % D0-HD|D4-MD
data(1,3,:) = [0.27883, 0.271, 0.246, 0.264, 0.264, 0.269, 0.258, 0.259, 0.243];     % D1-HD|D4-MD
data(1,4,:) = [0.14129, 0.144, 0.156, 0.146, 0.15, 0.148, 0.158, 0.154, 0.158];      % D2-HD|D4-MD
data(1,5,:) = [0.11485, 0.121, 0.142, 0.126, 0.132, 0.126, 0.143, 0.135, 0.152];     % D3-HD|D4-MD
data(1,6,:) = [0.093, 0.1, 0.121, 0.107, 0.109, 0.103, 0.116, 0.109, 0.131];         % D4-HD|D4-MD

% Region 2: SW
data(2,1,:) = [0.75801, 0.778, 0.821, 0.793, 0.831, 0.794, 0.859, 0.803, 0.863];
data(2,2,:) = [0.08595, 0.072, 0.069, 0.088, 0.075, 0.078, 0.059, 0.089, 0.057];
data(2,3,:) = [0.25739, 0.264, 0.27, 0.283, 0.271, 0.276, 0.251, 0.288, 0.241];
data(2,4,:) = [0.13322, 0.148, 0.161, 0.145, 0.162, 0.152, 0.174, 0.149, 0.176];
data(2,5,:) = [0.12641, 0.14, 0.155, 0.133, 0.158, 0.141, 0.183, 0.136, 0.193];
data(2,6,:) = [0.15504, 0.154, 0.165, 0.145, 0.166, 0.148, 0.192, 0.142, 0.197];

% Region 3: MW
data(3,1,:) = [0.67513, 0.699, 0.753, 0.707, 0.764, 0.703, 0.809, 0.732, 0.813];
data(3,2,:) = [0.07182, 0.05, 0.041, 0.045, 0.032, 0.044, 0.026, 0.04, 0.019];
data(3,3,:) = [0.2331, 0.207, 0.201, 0.201, 0.18, 0.198, 0.165, 0.191, 0.128];
data(3,4,:) = [0.1216, 0.133, 0.149, 0.138, 0.152, 0.137, 0.159, 0.143, 0.145];
data(3,5,:) = [0.11359, 0.138, 0.165, 0.147, 0.182, 0.147, 0.207, 0.16, 0.223];
data(3,6,:) = [0.13501, 0.171, 0.197, 0.176, 0.218, 0.178, 0.251, 0.198, 0.299];

% Region 4: GP
data(4,1,:) = [0.75328, 0.743, 0.748, 0.754, 0.748, 0.742, 0.783, 0.756, 0.781];
data(4,2,:) = [0.0473, 0.043, 0.033, 0.035, 0.032, 0.034, 0.03, 0.035, 0.018];
data(4,3,:) = [0.15107, 0.142, 0.123, 0.128, 0.116, 0.12, 0.113, 0.125, 0.081];
data(4,4,:) = [0.11103, 0.108, 0.104, 0.106, 0.101, 0.1, 0.102, 0.105, 0.087];
data(4,5,:) = [0.14703, 0.148, 0.154, 0.154, 0.153, 0.149, 0.161, 0.155, 0.163];
data(4,6,:) = [0.29685, 0.302, 0.334, 0.331, 0.346, 0.339, 0.377, 0.337, 0.431];

% Region 5: NE
data(5,1,:) = [0.76524, 0.723, 0.731, 0.757, 0.768, 0.757, 0.765, 0.737, 0.77];
data(5,2,:) = [0.07415, 0.061, 0.058, 0.052, 0.042, 0.062, 0.035, 0.055, 0.032];
data(5,3,:) = [0.26836, 0.229, 0.227, 0.235, 0.215, 0.243, 0.191, 0.231, 0.182];
data(5,4,:) = [0.14457, 0.134, 0.139, 0.149, 0.154, 0.144, 0.152, 0.142, 0.153];
data(5,5,:) = [0.13243, 0.133, 0.139, 0.148, 0.164, 0.141, 0.172, 0.14, 0.18];
data(5,6,:) = [0.14573, 0.166, 0.167, 0.172, 0.193, 0.167, 0.215, 0.168, 0.223];

% Region 6: SE
data(6,1,:) = [0.69532, 0.713, 0.756, 0.742, 0.8, 0.733, 0.817, 0.758, 0.849];
data(6,2,:) = [0.06467, 0.054, 0.042, 0.053, 0.039, 0.048, 0.026, 0.048, 0.016];
data(6,3,:) = [0.22258, 0.209, 0.189, 0.213, 0.198, 0.206, 0.155, 0.213, 0.115];
data(6,4,:) = [0.12338, 0.13, 0.137, 0.137, 0.153, 0.137, 0.149, 0.144, 0.139];
data(6,5,:) = [0.12153, 0.135, 0.157, 0.144, 0.177, 0.146, 0.199, 0.153, 0.222];
data(6,6,:) = [0.16316, 0.185, 0.229, 0.194, 0.233, 0.196, 0.289, 0.2, 0.357];




% Calculate percent change relative to Hist (dimension 3 index = 1)
hist_vals = data(:,:,1);
pct_change = 100 * (data - hist_vals) ./ hist_vals;

region_labels = {'NW','SW','MW','GP','NE','SE'};
prob_labels = {'HD|D4-MD','D0-HD|D4-MD','D1-HD|D4-MD','D2-HD|D4-MD','D3-HD|D4-MD','D4-HD|D4-MD'};
scenario_labels = {'245CN','245CF','245HN','245HF','585CN','585CF','585HN','585HF'};

% Define custom colors
% Colors based on U.S. Drought Monitor standards
custom_colors = [
    [0.5, 0.5, 0.5];     % AD|D0-MD - gray
    [1.0, 1.0, 0.0];     % D0 - yellow
    [1.0, 0.84, 0.0];    % D1 - gold (more distinct than light orange)
    [1.0, 0.4, 0.0];     % D2 - darker orange
    [1.0, 0.0, 0.0];     % D3 - red
    [0.55, 0.0, 0.0];    % D4 - dark red
];
figure;
for r = 1:6
    subplot(3,2,r);
    hold on;
%     yline(0, 'k-', 'LineWidth', 1, 'HandleVisibility', 'off'); % horizontal zero line
    for p = 1:6
        plot(1:8, squeeze(pct_change(r,p,2:end)), '-o', ...
             'Color', custom_colors(p,:), ...
             'DisplayName', prob_labels{p}, ...
             'LineWidth', 1);
    end
    xticks(1:8);
    xticklabels(scenario_labels);
    xtickangle(45);
    ylabel('% Change from Hist');
    title(['Region: ', region_labels{r}]);
    if r == 1
        legend('Location','best'); legend boxoff
    end
    grid on;
    hold off; box on;
%     ylim([-50, 200])
end

%% output the plot

fig = gcf;
fig.PaperUnits = 'inches';

% fig.PaperPosition = [0 0 17.7 8];
fig.PaperPosition = [0 0 10 12];
print('ScreenSizeFigure', '-dpng', '-r300')
