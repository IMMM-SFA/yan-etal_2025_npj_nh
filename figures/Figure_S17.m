% Define data as 3D array: [region, probability, scenario]
% Regions: NW, SW, MW, GP, NE, SE
% Probabilities: AD|D0-MD, D0-AD|D0-MD, ..., D4-AD|D0-MD
% Scenarios: Hist, 245CN, 245CF, 245HN, 245HF, 585CN, 585CF, 585HN, 585HF

data = zeros(6, 6, 9);

% Region 1: NW
data(1,1,:) = [0.478,0.500,0.503,0.504,0.517,0.498,0.518,0.517,0.533];
data(1,2,:) = [0.171,0.185,0.169,0.174,0.159,0.179,0.146,0.175,0.131];
data(1,3,:) = [0.196,0.197,0.201,0.201,0.205,0.200,0.204,0.207,0.205];
data(1,4,:) = [0.053,0.053,0.058,0.057,0.064,0.054,0.069,0.059,0.077];
data(1,5,:) = [0.036,0.037,0.042,0.041,0.049,0.038,0.053,0.043,0.063];
data(1,6,:) = [0.022,0.028,0.033,0.031,0.041,0.027,0.046,0.033,0.057];

% Region 2: SW
data(2,1,:) = [0.488,0.546,0.568,0.537,0.568,0.539,0.595,0.543,0.613];
data(2,2,:) = [0.236,0.223,0.192,0.217,0.183,0.203,0.153,0.187,0.140];
data(2,3,:) = [0.185,0.220,0.235,0.214,0.226,0.223,0.238,0.223,0.238];
data(2,4,:) = [0.035,0.051,0.066,0.051,0.068,0.056,0.085,0.062,0.094];
data(2,5,:) = [0.020,0.032,0.045,0.033,0.051,0.036,0.067,0.043,0.077];
data(2,6,:) = [0.011,0.020,0.031,0.022,0.040,0.023,0.053,0.030,0.063];

% Region 3: MW
data(3,1,:) = [0.448,0.462,0.538,0.480,0.563,0.474,0.611,0.506,0.642];
data(3,2,:) = [0.171,0.195,0.160,0.182,0.142,0.188,0.107,0.155,0.077];
data(3,3,:) = [0.183,0.184,0.228,0.196,0.236,0.194,0.232,0.215,0.200];
data(3,4,:) = [0.046,0.041,0.069,0.049,0.082,0.045,0.109,0.064,0.122];
data(3,5,:) = [0.030,0.025,0.048,0.032,0.060,0.028,0.093,0.043,0.128];
data(3,6,:) = [0.019,0.016,0.033,0.022,0.042,0.019,0.070,0.029,0.116];

% Region 4: GP
data(4,1,:) = [0.428,0.413,0.421,0.449,0.416,0.414,0.454,0.437,0.476];
data(4,2,:) = [0.177,0.198,0.209,0.210,0.196,0.214,0.183,0.234,0.145];
data(4,3,:) = [0.183,0.155,0.154,0.171,0.156,0.150,0.180,0.153,0.192];
data(4,4,:) = [0.039,0.031,0.030,0.035,0.032,0.026,0.043,0.026,0.060];
data(4,5,:) = [0.021,0.018,0.017,0.021,0.020,0.015,0.028,0.015,0.044];
data(4,6,:) = [0.008,0.011,0.011,0.012,0.013,0.008,0.020,0.009,0.035];

% Region 5: NE
data(5,1,:) = [0.443,0.348,0.356,0.380,0.390,0.378,0.387,0.359,0.402];
data(5,2,:) = [0.198,0.180,0.168,0.182,0.154,0.188,0.150,0.162,0.130];
data(5,3,:) = [0.171,0.121,0.129,0.137,0.154,0.133,0.153,0.131,0.163];
data(5,4,:) = [0.037,0.023,0.028,0.029,0.038,0.027,0.038,0.030,0.048];
data(5,5,:) = [0.023,0.014,0.018,0.018,0.025,0.017,0.026,0.020,0.034];
data(5,6,:) = [0.014,0.010,0.014,0.014,0.019,0.013,0.021,0.016,0.028];

% Region 6: SE
data(6,1,:) = [0.431,0.465,0.525,0.513,0.587,0.489,0.632,0.539,0.669];
data(6,2,:) = [0.206,0.219,0.223,0.216,0.185,0.228,0.167,0.217,0.137];
data(6,3,:) = [0.166,0.172,0.205,0.203,0.247,0.187,0.267,0.215,0.265];
data(6,4,:) = [0.032,0.036,0.047,0.046,0.072,0.038,0.090,0.051,0.112];
data(6,5,:) = [0.018,0.023,0.030,0.029,0.049,0.023,0.065,0.033,0.090];
data(6,6,:) = [0.008,0.015,0.020,0.019,0.033,0.013,0.043,0.022,0.065];

% Calculate percent change relative to Hist (dimension 3 index = 1)
hist_vals = data(:,:,1);
pct_change = 100 * (data - hist_vals) ./ hist_vals;

region_labels = {'NW','SW','MW','GP','NE','SE'};
prob_labels = {'AD|D0-MD','D0-AD|D0-MD','D1-AD|D0-MD','D2-AD|D0-MD','D3-AD|D0-MD','D4-AD|D0-MD'};
scenario_labels = {'245CN','245CF','245HN','245HF','585CN','585CF','585HN','585HF'};

% Define custom colors
% Colors based on U.S. Drought Monitor standards
custom_colors = [
    [0.5, 0.5, 0.5];     % AD|D0-MD - gray
    [1.0, 1.0, 0.0];     % D0 - yellow
    [1.0, 0.84, 0.0];    % D1 - gold (more distinct than light orange)
    [1.0, 0.4, 0.0];     % D2 - darker orange
    [1.0, 0.0, 0.0];     % D3 - red
    [0.55, 0.0, 0.0];    % D4 - dark red
];
figure;
for r = 1:6
    subplot(3,2,r);
    hold on;
%     yline(0, 'k-', 'LineWidth', 1, 'HandleVisibility', 'off'); % horizontal zero line
    for p = 1:6
        plot(1:8, squeeze(pct_change(r,p,2:end)), '-o', ...
             'Color', custom_colors(p,:), ...
             'DisplayName', prob_labels{p}, ...
             'LineWidth', 1);
    end
    xticks(1:8);
    xticklabels(scenario_labels);
    xtickangle(45);
    ylabel('% Change from Hist');
    title(['Region: ', region_labels{r}]);
    if r == 1
        legend('Location','best'); legend boxoff
    end
    grid on;
    hold off; box on;
%     ylim([-50, 200])
end

%% output the plot

fig = gcf;
fig.PaperUnits = 'inches';

% fig.PaperPosition = [0 0 17.7 8];
fig.PaperPosition = [0 0 10 12];
print('ScreenSizeFigure', '-dpng', '-r300')
