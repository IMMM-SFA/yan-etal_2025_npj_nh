% Define data as 3D array: [region, probability, scenario]
% Regions: NW, SW, MW, GP, NE, SE
% Probabilities: AD|D0-MD, D0-AD|D0-MD, ..., D4-AD|D0-MD
% Scenarios: Hist, 245CN, 245CF, 245HN, 245HF, 585CN, 585CF, 585HN, 585HF

data = zeros(6, 6, 9);

% Data matrix: data(region, probability_type, scenario)

% Region 1: NW
data(1,1,:) = [0.69988, 0.703, 0.714, 0.705, 0.717, 0.71, 0.731, 0.712, 0.733];
data(1,2,:) = [0.08879, 0.091, 0.082, 0.09, 0.101, 0.09, 0.093, 0.089, 0.093];
data(1,3,:) = [0.3003,  0.305, 0.302, 0.302, 0.309, 0.304, 0.315, 0.309, 0.309];
data(1,4,:) = [0.13356, 0.133, 0.143, 0.134, 0.134, 0.137, 0.143, 0.139, 0.144];
data(1,5,:) = [0.10058, 0.099, 0.108, 0.101, 0.1,   0.103, 0.106, 0.103, 0.11];
data(1,6,:) = [0.07665, 0.074, 0.079, 0.077, 0.073, 0.076, 0.073, 0.073, 0.078];

% Region 2: SW
data(2,1,:) = [0.75659, 0.775, 0.815, 0.789, 0.82, 0.791, 0.844, 0.798, 0.841];
data(2,2,:) = [0.09466, 0.097, 0.11, 0.118, 0.131, 0.105, 0.129, 0.124, 0.134];
data(2,3,:) = [0.26918, 0.303, 0.334, 0.319, 0.345, 0.313, 0.362, 0.329, 0.359];
data(2,4,:) = [0.13141, 0.141, 0.148, 0.135, 0.141, 0.143, 0.151, 0.136, 0.152];
data(2,5,:) = [0.12002, 0.118, 0.118, 0.11, 0.109, 0.119, 0.113, 0.108, 0.114];
data(2,6,:) = [0.14131, 0.116, 0.105, 0.108, 0.093, 0.111, 0.087, 0.1,   0.083];

% Region 3: MW
data(3,1,:) = [0.67376, 0.697, 0.749, 0.704, 0.759, 0.7, 0.803, 0.728, 0.803];
data(3,2,:) = [0.08257, 0.067, 0.068, 0.066, 0.07, 0.064, 0.068, 0.067, 0.072];
data(3,3,:) = [0.24871, 0.244, 0.268, 0.249, 0.285, 0.246, 0.305, 0.259, 0.312];
data(3,4,:) = [0.11908, 0.133, 0.151, 0.138, 0.158, 0.138, 0.175, 0.146, 0.178];
data(3,5,:) = [0.10525, 0.122, 0.135, 0.125, 0.134, 0.125, 0.144, 0.13,  0.143];
data(3,6,:) = [0.11815, 0.132, 0.128, 0.126, 0.112, 0.128, 0.11,  0.127, 0.097];

% Region 4: GP
data(4,1,:) = [0.75102, 0.739, 0.742, 0.749, 0.738, 0.736, 0.771, 0.75, 0.763];
data(4,2,:) = [0.05194, 0.051, 0.046, 0.047, 0.049, 0.044, 0.05,  0.047, 0.05];
data(4,3,:) = [0.16127, 0.16,  0.155, 0.157, 0.16,  0.143, 0.164, 0.157, 0.176];
data(4,4,:) = [0.11424, 0.114, 0.117, 0.118, 0.118, 0.11,  0.124, 0.118, 0.137];
data(4,5,:) = [0.14598, 0.147, 0.153, 0.153, 0.153, 0.15,  0.163, 0.154, 0.172];
data(4,6,:) = [0.2776,  0.266, 0.271, 0.274, 0.257, 0.289, 0.27,  0.274, 0.229];

% Region 5: NE
data(5,1,:) = [0.7631,  0.72,  0.726, 0.754, 0.764, 0.754, 0.76,  0.733, 0.763];
data(5,2,:) = [0.09182, 0.085, 0.089, 0.078, 0.08,  0.089, 0.076, 0.086, 0.083];
data(5,3,:) = [0.29616, 0.272, 0.28,  0.29,  0.305, 0.29,  0.298, 0.291, 0.311];
data(5,4,:) = [0.1394,  0.13,  0.133, 0.145, 0.15,  0.138, 0.153, 0.135, 0.153];
data(5,5,:) = [0.11714, 0.112, 0.112, 0.122, 0.12,  0.117, 0.124, 0.111, 0.119];
data(5,6,:) = [0.11858, 0.121, 0.113, 0.12,  0.108, 0.119, 0.11,  0.11,  0.097];

% Region 6: SE
data(6,1,:) = [0.69373, 0.711, 0.752, 0.739, 0.795, 0.73,  0.812, 0.755, 0.839];
data(6,2,:) = [0.07809, 0.074, 0.069, 0.073, 0.073, 0.067, 0.062, 0.074, 0.072];
data(6,3,:) = [0.24499, 0.247, 0.254, 0.253, 0.288, 0.25,  0.279, 0.27,  0.329];
data(6,4,:) = [0.12175, 0.129, 0.143, 0.137, 0.159, 0.138, 0.173, 0.144, 0.188];
data(6,5,:) = [0.11135, 0.119, 0.133, 0.127, 0.139, 0.128, 0.155, 0.129, 0.145];
data(6,6,:) = [0.13755, 0.142, 0.152, 0.148, 0.137, 0.147, 0.142, 0.138, 0.105];



% Calculate percent change relative to Hist (dimension 3 index = 1)
hist_vals = data(:,:,1);
pct_change = 100 * (data - hist_vals) ./ hist_vals;

region_labels = {'NW','SW','MW','GP','NE','SE'};
prob_labels = {'HD|D2-MD','D0-HD|D2-MD','D1-HD|D2-MD','D2-HD|D2-MD','D3-HD|D2-MD','D4-HD|D2-MD'};
scenario_labels = {'245CN','245CF','245HN','245HF','585CN','585CF','585HN','585HF'};

% Define custom colors
% Colors based on U.S. Drought Monitor standards
custom_colors = [
    [0.5, 0.5, 0.5];     % AD|D0-MD - gray
    [1.0, 1.0, 0.0];     % D0 - yellow
    [1.0, 0.84, 0.0];    % D1 - gold (more distinct than light orange)
    [1.0, 0.4, 0.0];     % D2 - darker orange
    [1.0, 0.0, 0.0];     % D3 - red
    [0.55, 0.0, 0.0];    % D4 - dark red
];
figure;
for r = 1:6
    subplot(3,2,r);
    hold on;
%     yline(0, 'k-', 'LineWidth', 1, 'HandleVisibility', 'off'); % horizontal zero line
    for p = 1:6
        plot(1:8, squeeze(pct_change(r,p,2:end)), '-o', ...
             'Color', custom_colors(p,:), ...
             'DisplayName', prob_labels{p}, ...
             'LineWidth', 1);
    end
    xticks(1:8);
    xticklabels(scenario_labels);
    xtickangle(45);
    ylabel('% Change from Hist');
    title(['Region: ', region_labels{r}]);
    if r == 1
        legend('Location','best'); legend boxoff
    end
    grid on;
    hold off; box on;
%     ylim([-50, 200])
end

%% output the plot

fig = gcf;
fig.PaperUnits = 'inches';

% fig.PaperPosition = [0 0 17.7 8];
fig.PaperPosition = [0 0 10 12];
print('ScreenSizeFigure', '-dpng', '-r300')
