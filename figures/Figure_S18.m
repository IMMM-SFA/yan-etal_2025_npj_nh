% Define data as 3D array: [region, probability, scenario]
% Regions: NW, SW, MW, GP, NE, SE
% Probabilities: AD|D0-MD, D0-AD|D0-MD, ..., D4-AD|D0-MD
% Scenarios: Hist, 245CN, 245CF, 245HN, 245HF, 585CN, 585CF, 585HN, 585HF

data = zeros(6, 6, 9);

% Region 1: NW
data(1,1,:) = [0.4907,0.519,0.526,0.522,0.539,0.52,0.543,0.539,0.558];
data(1,2,:) = [0.1308,0.13,0.114,0.121,0.114,0.118,0.104,0.119,0.097];
data(1,3,:) = [0.204,0.206,0.203,0.204,0.202,0.206,0.199,0.209,0.196];
data(1,4,:) = [0.0703,0.075,0.081,0.078,0.083,0.08,0.087,0.083,0.092];
data(1,5,:) = [0.0516,0.06,0.068,0.064,0.072,0.064,0.078,0.068,0.085];
data(1,6,:) = [0.034,0.049,0.06,0.055,0.068,0.052,0.075,0.06,0.088];

% Region 2: SW
data(2,1,:) = [0.5081,0.563,0.586,0.557,0.58,0.561,0.607,0.557,0.621];
data(2,2,:) = [0.1352,0.154,0.148,0.155,0.163,0.139,0.137,0.148,0.133];
data(2,3,:) = [0.2234,0.239,0.242,0.233,0.23,0.236,0.237,0.23,0.238];
data(2,4,:) = [0.071,0.077,0.085,0.075,0.078,0.083,0.093,0.078,0.099];
data(2,5,:) = [0.0485,0.055,0.064,0.055,0.06,0.061,0.076,0.058,0.083];
data(2,6,:) = [0.0301,0.038,0.047,0.04,0.05,0.042,0.063,0.043,0.07];

% Region 3: MW
data(3,1,:) = [0.4634,0.484,0.569,0.507,0.587,0.504,0.628,0.539,0.647];
data(3,2,:) = [0.1157,0.115,0.101,0.11,0.106,0.104,0.086,0.101,0.072];
data(3,3,:) = [0.1932,0.204,0.222,0.206,0.229,0.208,0.217,0.214,0.194];
data(3,4,:) = [0.0688,0.072,0.099,0.079,0.102,0.081,0.119,0.092,0.123];
data(3,5,:) = [0.0512,0.054,0.082,0.062,0.084,0.063,0.113,0.075,0.133];
data(3,6,:) = [0.0346,0.039,0.065,0.049,0.065,0.048,0.092,0.057,0.125];

% Region 4: GP
data(4,1,:) = [0.433,0.427,0.443,0.467,0.433,0.435,0.47,0.461,0.48];
data(4,2,:) = [0.149,0.139,0.149,0.149,0.16,0.133,0.152,0.16,0.139];
data(4,3,:) = [0.196,0.182,0.189,0.201,0.178,0.193,0.194,0.198,0.193];
data(4,4,:) = [0.049,0.051,0.051,0.057,0.046,0.053,0.056,0.05,0.063];
data(4,5,:) = [0.028,0.034,0.033,0.038,0.03,0.034,0.039,0.032,0.047];
data(4,6,:) = [0.012,0.021,0.021,0.023,0.02,0.021,0.028,0.021,0.038];

% Region 5: NE
data(5,1,:) = [0.456,0.361,0.37,0.402,0.413,0.394,0.405,0.374,0.421];
data(5,2,:) = [0.132,0.12,0.115,0.112,0.103,0.124,0.106,0.113,0.103];
data(5,3,:) = [0.194,0.15,0.15,0.164,0.167,0.16,0.163,0.148,0.168];
data(5,4,:) = [0.06,0.042,0.045,0.053,0.059,0.047,0.056,0.046,0.061];
data(5,5,:) = [0.042,0.029,0.033,0.04,0.045,0.034,0.043,0.035,0.048];
data(5,6,:) = [0.028,0.021,0.027,0.033,0.039,0.028,0.037,0.031,0.041];

% Region 6: SE
data(6,1,:) = [0.447,0.488,0.56,0.544,0.621,0.52,0.654,0.568,0.685];
data(6,2,:) = [0.145,0.149,0.147,0.135,0.129,0.139,0.129,0.14,0.118];
data(6,3,:) = [0.198,0.203,0.232,0.228,0.251,0.224,0.263,0.235,0.258];
data(6,4,:) = [0.054,0.062,0.079,0.08,0.101,0.073,0.11,0.083,0.122];
data(6,5,:) = [0.033,0.044,0.059,0.059,0.08,0.051,0.089,0.062,0.106];
data(6,6,:) = [0.016,0.031,0.044,0.042,0.059,0.033,0.063,0.047,0.08];

% Calculate percent change relative to Hist (dimension 3 index = 1)
hist_vals = data(:,:,1);
pct_change = 100 * (data - hist_vals) ./ hist_vals;

region_labels = {'NW','SW','MW','GP','NE','SE'};
prob_labels = {'AD|D1-MD','D0-AD|D1-MD','D1-AD|D1-MD','D2-AD|D1-MD','D3-AD|D1-MD','D4-AD|D1-MD'};
scenario_labels = {'245CN','245CF','245HN','245HF','585CN','585CF','585HN','585HF'};

% Define custom colors
% Colors based on U.S. Drought Monitor standards
custom_colors = [
    [0.5, 0.5, 0.5];     % AD|D0-MD - gray
    [1.0, 1.0, 0.0];     % D0 - yellow
    [1.0, 0.84, 0.0];    % D1 - gold (more distinct than light orange)
    [1.0, 0.4, 0.0];     % D2 - darker orange
    [1.0, 0.0, 0.0];     % D3 - red
    [0.55, 0.0, 0.0];    % D4 - dark red
];
figure;
for r = 1:6
    subplot(3,2,r);
    hold on;
%     yline(0, 'k-', 'LineWidth', 1, 'HandleVisibility', 'off'); % horizontal zero line
    for p = 1:6
        plot(1:8, squeeze(pct_change(r,p,2:end)), '-o', ...
             'Color', custom_colors(p,:), ...
             'DisplayName', prob_labels{p}, ...
             'LineWidth', 1);
    end
    xticks(1:8);
    xticklabels(scenario_labels);
    xtickangle(45);
    ylabel('% Change from Hist');
    title(['Region: ', region_labels{r}]);
    if r == 1
        legend('Location','best'); legend boxoff
    end
    grid on;
    hold off; box on;
%     ylim([-50, 200])
end

%% output the plot

fig = gcf;
fig.PaperUnits = 'inches';

% fig.PaperPosition = [0 0 17.7 8];
fig.PaperPosition = [0 0 10 12];
print('ScreenSizeFigure', '-dpng', '-r300')
