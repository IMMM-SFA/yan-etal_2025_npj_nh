% Define data as 3D array: [region, probability, scenario]
% Regions: NW, SW, MW, GP, NE, SE
% Probabilities: AD|D0-MD, D0-AD|D0-MD, ..., D4-AD|D0-MD
% Scenarios: Hist, 245CN, 245CF, 245HN, 245HF, 585CN, 585CF, 585HN, 585HF

data = zeros(6, 6, 9);

% Data matrix: data(region, probability_type, scenario)

% Region 1: NW
data(1,1,:) = [0.4956,0.528,0.539,0.531,0.553,0.53,0.561,0.551,0.58];
data(1,2,:) = [0.1107,0.095,0.072,0.086,0.074,0.082,0.064,0.077,0.058];
data(1,3,:) = [0.2011,0.193,0.174,0.187,0.175,0.186,0.164,0.183,0.155];
data(1,4,:) = [0.0792,0.088,0.095,0.091,0.095,0.093,0.098,0.097,0.099];
data(1,5,:) = [0.062,0.079,0.096,0.085,0.098,0.088,0.107,0.095,0.116];
data(1,6,:) = [0.0427,0.072,0.102,0.082,0.11,0.081,0.128,0.098,0.152];

% Region 2: SW
data(2,1,:) = [0.513,0.572,0.603,0.57,0.603,0.574,0.632,0.571,0.646];
data(2,2,:) = [0.0969,0.101,0.091,0.096,0.115,0.085,0.095,0.098,0.103];
data(2,3,:) = [0.2135,0.224,0.217,0.215,0.221,0.211,0.216,0.214,0.225];
data(2,4,:) = [0.0883,0.099,0.109,0.099,0.098,0.106,0.112,0.099,0.113];
data(2,5,:) = [0.0683,0.083,0.1,0.087,0.087,0.095,0.107,0.087,0.106];
data(2,6,:) = [0.0462,0.064,0.086,0.073,0.081,0.077,0.102,0.073,0.099];

% Region 3: MW
data(3,1,:) = [0.4681,0.493,0.589,0.52,0.614,0.517,0.657,0.562,0.665];
data(3,2,:) = [0.0931,0.065,0.045,0.057,0.048,0.05,0.042,0.044,0.051];
data(3,3,:) = [0.1868,0.174,0.152,0.163,0.159,0.156,0.146,0.148,0.159];
data(3,4,:) = [0.0787,0.092,0.111,0.097,0.117,0.099,0.12,0.107,0.122];
data(3,5,:) = [0.0637,0.086,0.132,0.1,0.139,0.105,0.16,0.126,0.157];
data(3,6,:) = [0.0458,0.076,0.148,0.102,0.152,0.107,0.188,0.137,0.177];

% Region 4: GP
data(4,1,:) = [0.4354,0.433,0.457,0.478,0.453,0.444,0.491,0.475,0.493];
data(4,2,:) = [0.1356,0.097,0.083,0.095,0.091,0.071,0.088,0.08,0.106];
data(4,3,:) = [0.1995,0.182,0.183,0.197,0.182,0.178,0.187,0.189,0.19];
data(4,4,:) = [0.0548,0.068,0.079,0.08,0.074,0.081,0.083,0.084,0.077];
data(4,5,:) = [0.032,0.051,0.064,0.063,0.06,0.066,0.072,0.069,0.064];
data(4,6,:) = [0.0135,0.035,0.048,0.043,0.046,0.048,0.061,0.054,0.057];

% Region 5: NE
data(5,1,:) = [0.4601,0.366,0.377,0.411,0.427,0.4,0.417,0.381,0.442];
data(5,2,:) = [0.1051,0.085,0.073,0.067,0.052,0.085,0.059,0.076,0.056];
data(5,3,:) = [0.1915,0.149,0.143,0.148,0.136,0.155,0.14,0.141,0.141];
data(5,4,:) = [0.0715,0.055,0.06,0.07,0.077,0.062,0.073,0.06,0.079];
data(5,5,:) = [0.0541,0.043,0.052,0.063,0.077,0.051,0.07,0.052,0.079];
data(5,6,:) = [0.0379,0.035,0.049,0.063,0.085,0.047,0.075,0.052,0.088];

% Region 6: SE
data(6,1,:) = [0.4516,0.497,0.578,0.557,0.647,0.531,0.681,0.582,0.721];
data(6,2,:) = [0.1186,0.107,0.082,0.082,0.061,0.083,0.067,0.08,0.068];
data(6,3,:) = [0.2016,0.199,0.203,0.202,0.188,0.204,0.203,0.202,0.205];
data(6,4,:) = [0.0659,0.079,0.105,0.103,0.125,0.098,0.133,0.107,0.139];
data(6,5,:) = [0.0432,0.063,0.098,0.093,0.137,0.083,0.144,0.101,0.157];
data(6,6,:) = [0.0223,0.049,0.089,0.078,0.137,0.063,0.134,0.092,0.152];


% Calculate percent change relative to Hist (dimension 3 index = 1)
hist_vals = data(:,:,1);
pct_change = 100 * (data - hist_vals) ./ hist_vals;

region_labels = {'NW','SW','MW','GP','NE','SE'};
prob_labels = {'AD|D2-MD','D0-AD|D2-MD','D1-AD|D2-MD','D2-AD|D2-MD','D3-AD|D2-MD','D4-AD|D2-MD'};
scenario_labels = {'245CN','245CF','245HN','245HF','585CN','585CF','585HN','585HF'};

% Define custom colors
% Colors based on U.S. Drought Monitor standards
custom_colors = [
    [0.5, 0.5, 0.5];     % AD|D0-MD - gray
    [1.0, 1.0, 0.0];     % D0 - yellow
    [1.0, 0.84, 0.0];    % D1 - gold (more distinct than light orange)
    [1.0, 0.4, 0.0];     % D2 - darker orange
    [1.0, 0.0, 0.0];     % D3 - red
    [0.55, 0.0, 0.0];    % D4 - dark red
];
figure;
for r = 1:6
    subplot(3,2,r);
    hold on;
%     yline(0, 'k-', 'LineWidth', 1, 'HandleVisibility', 'off'); % horizontal zero line
    for p = 1:6
        plot(1:8, squeeze(pct_change(r,p,2:end)), '-o', ...
             'Color', custom_colors(p,:), ...
             'DisplayName', prob_labels{p}, ...
             'LineWidth', 1);
    end
    xticks(1:8);
    xticklabels(scenario_labels);
    xtickangle(45);
    ylabel('% Change from Hist');
    title(['Region: ', region_labels{r}]);
    if r == 1
        legend('Location','best'); legend boxoff
    end
    grid on;
    hold off; box on;
%     ylim([-50, 200])
end

%% output the plot

fig = gcf;
fig.PaperUnits = 'inches';

% fig.PaperPosition = [0 0 17.7 8];
fig.PaperPosition = [0 0 10 12];
print('ScreenSizeFigure', '-dpng', '-r300')
