% Define data as 3D array: [region, probability, scenario]
% Regions: NW, SW, MW, GP, NE, SE
% Probabilities: AD|D0-MD, D0-AD|D0-MD, ..., D4-AD|D0-MD
% Scenarios: Hist, 245CN, 245CF, 245HN, 245HF, 585CN, 585CF, 585HN, 585HF

data = zeros(6, 6, 9);

% Data matrix: data(region, probability_type, scenario)

% Region 1: NW
data(1,1,:) = [0.663, 0.670, 0.678, 0.675, 0.687, 0.676, 0.703, 0.678, 0.708];
data(1,2,:) = [0.280, 0.269, 0.256, 0.252, 0.227, 0.260, 0.223, 0.253, 0.200];
data(1,3,:) = [0.295, 0.305, 0.319, 0.315, 0.325, 0.313, 0.342, 0.319, 0.345];
data(1,4,:) = [0.048, 0.052, 0.057, 0.058, 0.070, 0.056, 0.074, 0.058, 0.085];
data(1,5,:) = [0.025, 0.027, 0.029, 0.031, 0.040, 0.030, 0.041, 0.030, 0.049];
data(1,6,:) = [0.015, 0.017, 0.017, 0.019, 0.024, 0.018, 0.023, 0.017, 0.029];

% Region 2: SW
data(2,1,:) = [0.718, 0.742, 0.783, 0.765, 0.792, 0.762, 0.809, 0.776, 0.820];
data(2,2,:) = [0.256, 0.271, 0.268, 0.248, 0.233, 0.246, 0.243, 0.234, 0.189];
data(2,3,:) = [0.308, 0.333, 0.361, 0.345, 0.364, 0.350, 0.380, 0.354, 0.379];
data(2,4,:) = [0.070, 0.067, 0.077, 0.080, 0.093, 0.080, 0.093, 0.088, 0.121];
data(2,5,:) = [0.045, 0.040, 0.045, 0.051, 0.059, 0.050, 0.056, 0.056, 0.079];
data(2,6,:) = [0.039, 0.030, 0.032, 0.041, 0.043, 0.037, 0.037, 0.044, 0.052];

% Region 3: MW
data(3,1,:) = [0.641, 0.661, 0.716, 0.669, 0.730, 0.663, 0.777, 0.695, 0.788];
data(3,2,:) = [0.248, 0.245, 0.233, 0.232, 0.211, 0.241, 0.202, 0.228, 0.135];
data(3,3,:) = [0.276, 0.298, 0.341, 0.309, 0.360, 0.304, 0.396, 0.328, 0.384];
data(3,4,:) = [0.055, 0.059, 0.073, 0.064, 0.083, 0.060, 0.096, 0.070, 0.136];
data(3,5,:) = [0.034, 0.034, 0.042, 0.037, 0.046, 0.034, 0.053, 0.040, 0.084];
data(3,6,:) = [0.028, 0.026, 0.028, 0.027, 0.029, 0.024, 0.031, 0.028, 0.048];

% Region 4: GP
data(4,1,:) = [0.694, 0.688, 0.687, 0.685, 0.691, 0.680, 0.726, 0.698, 0.733];
data(4,2,:) = [0.143, 0.126, 0.131, 0.144, 0.113, 0.120, 0.110, 0.125, 0.093];
data(4,3,:) = [0.260, 0.250, 0.262, 0.266, 0.246, 0.245, 0.251, 0.258, 0.250];
data(4,4,:) = [0.104, 0.108, 0.109, 0.104, 0.115, 0.109, 0.124, 0.113, 0.137];
data(4,5,:) = [0.088, 0.095, 0.091, 0.085, 0.104, 0.097, 0.116, 0.098, 0.129];
data(4,6,:) = [0.099, 0.108, 0.094, 0.086, 0.113, 0.108, 0.126, 0.104, 0.124];

% Region 5: NE
data(5,1,:) = [0.711, 0.667, 0.671, 0.703, 0.716, 0.698, 0.708, 0.679, 0.719];
data(5,2,:) = [0.328, 0.305, 0.295, 0.327, 0.313, 0.321, 0.299, 0.332, 0.265];
data(5,3,:) = [0.291, 0.272, 0.280, 0.293, 0.314, 0.286, 0.316, 0.271, 0.339];
data(5,4,:) = [0.047, 0.045, 0.048, 0.043, 0.048, 0.046, 0.050, 0.039, 0.062];
data(5,5,:) = [0.026, 0.026, 0.027, 0.023, 0.025, 0.026, 0.026, 0.021, 0.032];
data(5,6,:) = [0.019, 0.020, 0.020, 0.016, 0.017, 0.019, 0.017, 0.015, 0.020];

% Region 6: SE
data(6,1,:) = [0.649, 0.657, 0.697, 0.690, 0.751, 0.681, 0.757, 0.710, 0.793];
data(6,2,:) = [0.293, 0.293, 0.285, 0.286, 0.283, 0.295, 0.270, 0.291, 0.248];
data(6,3,:) = [0.261, 0.269, 0.302, 0.294, 0.345, 0.289, 0.360, 0.311, 0.401];
data(6,4,:) = [0.045, 0.046, 0.055, 0.054, 0.064, 0.049, 0.069, 0.055, 0.082];
data(6,5,:) = [0.027, 0.027, 0.031, 0.031, 0.035, 0.027, 0.036, 0.031, 0.041];
data(6,6,:) = [0.023, 0.022, 0.024, 0.025, 0.024, 0.021, 0.023, 0.023, 0.022];




% Calculate percent change relative to Hist (dimension 3 index = 1)
hist_vals = data(:,:,1);
pct_change = 100 * (data - hist_vals) ./ hist_vals;

region_labels = {'NW','SW','MW','GP','NE','SE'};
prob_labels = {'HD|D0-MD','D0-HD|D0-MD','D1-HD|D0-MD','D2-HD|D0-MD','D3-HD|D0-MD','D4-HD|D0-MD'};
scenario_labels = {'245CN','245CF','245HN','245HF','585CN','585CF','585HN','585HF'};

% Define custom colors
% Colors based on U.S. Drought Monitor standards
custom_colors = [
    [0.5, 0.5, 0.5];     % AD|D0-MD - gray
    [1.0, 1.0, 0.0];     % D0 - yellow
    [1.0, 0.84, 0.0];    % D1 - gold (more distinct than light orange)
    [1.0, 0.4, 0.0];     % D2 - darker orange
    [1.0, 0.0, 0.0];     % D3 - red
    [0.55, 0.0, 0.0];    % D4 - dark red
];
figure;
for r = 1:6
    subplot(3,2,r);
    hold on;
%     yline(0, 'k-', 'LineWidth', 1, 'HandleVisibility', 'off'); % horizontal zero line
    for p = 1:6
        plot(1:8, squeeze(pct_change(r,p,2:end)), '-o', ...
             'Color', custom_colors(p,:), ...
             'DisplayName', prob_labels{p}, ...
             'LineWidth', 1);
    end
    xticks(1:8);
    xticklabels(scenario_labels);
    xtickangle(45);
    ylabel('% Change from Hist');
    title(['Region: ', region_labels{r}]);
    if r == 1
        legend('Location','best'); legend boxoff
    end
    grid on;
    hold off; box on;
%     ylim([-50, 200])
end

%% output the plot

fig = gcf;
fig.PaperUnits = 'inches';

% fig.PaperPosition = [0 0 17.7 8];
fig.PaperPosition = [0 0 10 12];
print('ScreenSizeFigure', '-dpng', '-r300')
